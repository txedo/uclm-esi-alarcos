<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE struts PUBLIC 
    "-//Apache Software Foundation//DTD Struts Configuration 2.0//EN"
    "http://struts.apache.org/dtds/struts-2.0.dtd">

<struts>
	<!-- When adding an action in struts.xml, edit applicationContext.xml to instantiate it by Spring -->
	<package name="default" extends="struts-default">
		<!-- Interceptors -->
	    <interceptors>
	    	<!-- Interceptor to pass messages between actions -->
	    	<interceptor name="redirectMessage" class="redirectMessageInterceptor" />
	    	<interceptor-stack name="redirectMessageAndParams">
            	<interceptor-ref name="redirectMessage"/>
            	<interceptor-ref name="paramsPrepareParamsStack"/>
            </interceptor-stack>
            <!-- Interceptor to handle allowing only certains roles to certain actions -->
            <interceptor name="adminOnly" class="adminInterceptor"/>
            <interceptor name="executiveOnly" class="executiveInterceptor"/>
            <interceptor name="managerOnly" class="managerInterceptor"/>
            <interceptor name="allUsers" class="allUsersInterceptor"/>
            <interceptor-stack name="allButUsers">
            	<interceptor-ref name="adminOnly"/>
            	<interceptor-ref name="executiveOnly"/>
            	<interceptor-ref name="managerOnly"/>
            </interceptor-stack>
        </interceptors>
        
        <!-- Actions -->
		<action name="index" class="indexAction">
			<result>/jsp/index.jsp</result>
		</action>
		<action name="helloWorld" class="helloWorldAction"> 
			<result name="input">/jsp/index.jsp</result>
			<result>/jsp/helloWorld.jsp</result>
		</action>
		<action name="startVisualization" class="startVisualizationAction">
			<interceptor-ref name="allButUsers"/>
			<result>/jsp/visualization.jsp</result>
		</action>
		<action name="showAdminPanel" class="showAdminPanelAction">
			<interceptor-ref name="adminOnly"></interceptor-ref>
			<result>/jsp/admin/adminPanel.jsp</result>
		</action>
		<action name="showMyAccount" class="showMyAccountAction">
			<interceptor-ref name="allUsers"/>
			<result>/jsp/myAccount.jsp</result>
		</action>
		<action name="contactUs" class="contactUsAction">
			<result>/jsp/contactUs.jsp</result>
		</action>
		
		<!-- Company related actions -->
		<action name="listCompanies" class="companyAction">
			<!-- <interceptor-ref name="allUsers"></interceptor-ref> -->
			<interceptor-ref name="redirectMessageAndParams"/>
			<result name="error">/jsp/viewCompanies.jsp</result>
			<result name="input">/jsp/viewCompanies.jsp</result>
			<result name="success">/jsp/viewCompanies.jsp</result>
		</action>
		<action name="showCompanyForm" class="companyAction" method="showForm">
			<!-- <interceptor-ref name="adminOnly"></interceptor-ref> -->
			<interceptor-ref name="redirectMessageAndParams"/>
			<result name="error">/jsp/viewCompanies.jsp</result>
			<result name="input">/jsp/formCompany.jsp</result>
			<result name="success">/jsp/formCompany.jsp</result>
		</action>
		<action name="saveCompany" class="companyAction" method="save">
			<!-- <interceptor-ref name="adminOnly"></interceptor-ref> -->
			<interceptor-ref name="redirectMessageAndParams"/>
			<result name="error">/jsp/formCompany.jsp</result>
			<result name="input">/jsp/formCompany.jsp</result>
			<result name="success" type="redirect-action">listCompanies.action</result>
		</action>
		<action name="editCompany" class="companyAction" method="edit">
			<!-- <interceptor-ref name="adminOnly"></interceptor-ref> -->
			<interceptor-ref name="redirectMessageAndParams"/>
			<result name="error">/jsp/viewCompanies.jsp</result>
			<result name="input">
				<param name="location">/jsp/formCompany.jsp?id=${id}</param>
      			<param name="parse">true</param>
      			<param name="encode">true</param>
			</result>
			<result name="success" type="redirect-action">listCompanies.action</result>
		</action>
		<action name="deleteCompany" class="companyAction" method="delete">
			<!-- <interceptor-ref name="adminOnly"></interceptor-ref> -->
			<interceptor-ref name="redirectMessageAndParams"/>
			<result name="error">/jsp/viewCompanies.jsp</result>
			<result name="input">/jsp/viewCompanies.jsp</result>
			<result name="success" type="redirect-action">listCompanies.action</result>
		</action>
		<!-- End of Company related actions -->
		
		<!-- Factory related actions -->
		<action name="listFactories" class="factoryAction">
			<!-- <interceptor-ref name="allUsers"></interceptor-ref> -->
			<interceptor-ref name="redirectMessageAndParams"/>
			<result name="error">/jsp/viewFactories.jsp</result>
			<result name="input">/jsp/viewFactories.jsp</result>
			<result name="success">/jsp/viewFactories.jsp</result>
		</action>
		<action name="showFactoryForm" class="factoryAction" method="showForm">
			<!-- <interceptor-ref name="adminOnly"></interceptor-ref> -->
			<interceptor-ref name="redirectMessageAndParams"/>
			<result name="error">/jsp/formFactory.jsp</result>
			<result name="input">/jsp/formFactory.jsp</result>
			<result name="success">/jsp/formFactory.jsp</result>
		</action>
		<action name="saveFactory" class="factoryAction" method="save">
			<!-- <interceptor-ref name="adminOnly"></interceptor-ref> -->
			<interceptor-ref name="redirectMessageAndParams"/>
			<result name="error">/jsp/formFactory.jsp</result>
			<result name="input">/jsp/formFactory.jsp</result>
			<result name="success">listFactories.action</result>
		</action>
		<action name="editFactory" class="factoryAction" method="edit">
			<!-- <interceptor-ref name="adminOnly"></interceptor-ref> -->
			<interceptor-ref name="redirectMessageAndParams"/>
			<result name="error">/jsp/viewFactories.jsp</result>
			<result name="input">
				<param name="location">/jsp/formFactory.jsp?id=${id}</param>
      			<param name="parse">true</param>
      			<param name="encode">true</param>
			</result>
			<result name="success" type="redirect-action">listFactories.action</result>
		</action>
	</package>
</struts>
