<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE struts PUBLIC 
    "-//Apache Software Foundation//DTD Struts Configuration 2.0//EN"
    "http://struts.apache.org/dtds/struts-2.0.dtd">

<struts>
	<!-- When adding an action in struts.xml, edit applicationContext.xml to instantiate it by Spring -->
	<package name="struts" namespace="/" extends="struts-default">    
		<!-- Interceptors -->
	    <interceptors>
	    	<!-- Interceptor to pass messages between actions -->
	    	<interceptor name="redirectMessage" class="redirectMessageInterceptor" />
	    	<interceptor-stack name="redirectMessageAndParams">
            	<interceptor-ref name="redirectMessage"/>
            	<interceptor-ref name="paramsPrepareParamsStack"/>
            </interceptor-stack>
            <!-- Interceptor to handle roles and actions -->
            <interceptor name="adminOnly" class="adminInterceptor"/>
            <interceptor name="executiveOnly" class="executiveInterceptor"/>
            <interceptor name="managerOnly" class="managerInterceptor"/>
            <interceptor name="allUsers" class="allUsersInterceptor"/>
            <interceptor-stack name="allButUsers">
            	<interceptor-ref name="adminOnly"/>
            	<interceptor-ref name="executiveOnly"/>
            	<interceptor-ref name="managerOnly"/>
            </interceptor-stack>
        </interceptors>
        
        <!-- Actions -->
        <action name="">
			<result>/index.jsp</result>
		</action>
		<action name="index">
			<result>/index.jsp</result>
		</action>
		<action name="login">
			<result>/login.jsp</result>
		</action>
		<action name="logout">
			<result>/logout.jsp</result>
		</action>
		<action name="contactUs">
			<result>/contactUs.jsp</result>
		</action>
		<action name="visualization" class="visualizationAction">
			<!-- <interceptor-ref name="allButUsers"/> -->
			<interceptor-ref name="redirectMessageAndParams"/>
			<result name="success">/jsp/visualization.jsp</result>
			<result name="input">/jsp/visualization.jsp</result>
			<result name="error">/jsp/visualization.jsp</result>
		</action>
		<action name="listProfiles" class="profileAction">
			<!-- <interceptor-ref name="allUsers"></interceptor-ref> -->
			<interceptor-ref name="redirectMessageAndParams"/>
			<result name="error">/jsp/admin/viewProfiles.jsp</result>
			<result name="input">/jsp/admin/viewProfiles.jsp</result>
			<result name="success">/jsp/admin/viewProfiles.jsp</result>
		</action>
		<action name="showProfileForm" class="profileAction" method="showForm">
			<!-- <interceptor-ref name="adminOnly"></interceptor-ref> -->
			<interceptor-ref name="redirectMessageAndParams"/>
			<result name="error">/jsp/admin/viewProfiles.jsp</result>
			<result name="input">/jsp/admin/formProfile.jsp</result>
			<result name="success">/jsp/admin/formProfile.jsp</result>
		</action>
		<action name="saveProfile" class="profileAction" method="save">
			<!-- <interceptor-ref name="adminOnly"></interceptor-ref> -->
			<interceptor-ref name="redirectMessageAndParams"/>
			<result name="error">/jsp/admin/formProfile.jsp</result>
			<result name="input">/jsp/admin/formProfile.jsp</result>
			<result name="success" type="redirectAction">listProfiles</result>
		</action>
		
		<!-- Company related actions -->
		<action name="listCompanies" class="companyAction">
			<!-- <interceptor-ref name="allUsers"></interceptor-ref> -->
			<interceptor-ref name="redirectMessageAndParams"/>
			<result name="error">/jsp/viewCompanies.jsp</result>
			<result name="input">/jsp/viewCompanies.jsp</result>
			<result name="success">/jsp/viewCompanies.jsp</result>
		</action>
		<action name="showCompanyForm" class="companyAction" method="showForm">
			<!-- <interceptor-ref name="adminOnly"></interceptor-ref> -->
			<interceptor-ref name="redirectMessageAndParams"/>
			<result name="error">/jsp/viewCompanies.jsp</result>
			<result name="input">/jsp/formCompany.jsp</result>
			<result name="success">/jsp/formCompany.jsp</result>
		</action>
		<action name="viewCompany" class="companyAction" method="get">
			<!-- <interceptor-ref name="adminOnly"></interceptor-ref> -->
			<interceptor-ref name="redirectMessageAndParams"/>
			<result name="error">/jsp/viewCompany.jsp</result>
			<result name="input">/jsp/viewCompany.jsp</result>
			<result name="success">/jsp/viewCompany.jsp</result>
		</action>
		<action name="saveCompany" class="companyAction" method="save">
			<!-- <interceptor-ref name="adminOnly"></interceptor-ref> -->
			<interceptor-ref name="redirectMessageAndParams"/>
			<result name="error">/jsp/formCompany.jsp</result>
			<result name="input">/jsp/formCompany.jsp</result>
			<result name="success" type="redirectAction">listCompanies</result>
		</action>
		<action name="editCompany" class="companyAction" method="edit">
			<!-- <interceptor-ref name="adminOnly"></interceptor-ref> -->
			<interceptor-ref name="redirectMessageAndParams"/>
			<result name="error">/jsp/viewCompanies.jsp</result>
			<result name="input">
				<param name="location">/jsp/formCompany.jsp?id=${id}</param>
      			<param name="parse">true</param>
      			<param name="encode">true</param>
			</result>
			<result name="success" type="redirectAction">listCompanies</result>
		</action>
		<action name="deleteCompany" class="companyAction" method="delete">
			<!-- <interceptor-ref name="adminOnly"></interceptor-ref> -->
			<interceptor-ref name="redirectMessageAndParams"/>
			<result name="error">/jsp/viewCompanies.jsp</result>
			<result name="input">/jsp/viewCompanies.jsp</result>
			<result name="success" type="redirectAction">listCompanies</result>
		</action>
		<!-- End of Company related actions -->
		
		<!-- Factory related actions -->
		<action name="listFactories" class="factoryAction">
			<!-- <interceptor-ref name="allUsers"></interceptor-ref> -->
			<interceptor-ref name="redirectMessageAndParams"/>
			<result name="error">/jsp/viewFactories.jsp</result>
			<result name="input">/jsp/viewFactories.jsp</result>
			<result name="success">/jsp/viewFactories.jsp</result>
		</action>
		<action name="showFactoryForm" class="factoryAction" method="showForm">
			<!-- <interceptor-ref name="adminOnly"></interceptor-ref> -->
			<interceptor-ref name="redirectMessageAndParams"/>
			<result name="error">/jsp/formFactory.jsp</result>
			<result name="input">/jsp/formFactory.jsp</result>
			<result name="success">/jsp/formFactory.jsp</result>
		</action>
		<action name="saveFactory" class="factoryAction" method="save">
			<!-- <interceptor-ref name="adminOnly"></interceptor-ref> -->
			<interceptor-ref name="redirectMessageAndParams"/>
			<result name="error">/jsp/formFactory.jsp</result>
			<result name="input">/jsp/formFactory.jsp</result>
			<result name="success" type="redirectAction">listFactories</result>
		</action>
		<action name="editFactory" class="factoryAction" method="edit">
			<!-- <interceptor-ref name="adminOnly"></interceptor-ref> -->
			<interceptor-ref name="redirectMessageAndParams"/>
			<result name="error">/jsp/viewFactories.jsp</result>
			<result name="input">
				<param name="location">/jsp/formFactory.jsp?id=${id}</param>
      			<param name="parse">true</param>
      			<param name="encode">true</param>
			</result>
			<result name="success" type="redirectAction">listFactories</result>
		</action>
		<action name="deleteFactory" class="factoryAction" method="delete">
			<!-- <interceptor-ref name="adminOnly"></interceptor-ref> -->
			<interceptor-ref name="redirectMessageAndParams"/>
			<result name="error">/jsp/viewFactories.jsp</result>
			<result name="input">/jsp/viewFactories.jsp</result>
			<result name="success" type="redirectAction">listFactories</result>
		</action>
		<!-- End of Factory related actions -->
	</package>
	
	<package name="json" extends="json-default">
		<action name="json_p_*" class="profileAction" method="{1}">
			<result name="success" type="json">
				<param name="noCache">true</param>
				<!-- <param name="excludeProperties">companies, projects</param> -->
				<!-- <param name="excludeNullProperties">true</param> -->
			</result>
		</action>
		<action name="json_*" class="visualizationAction" method="{1}">
			<result name="success" type="json">
				<param name="noCache">true</param>
				<!-- <param name="excludeProperties">companies, projects</param> -->
				<!-- <param name="excludeNullProperties">true</param> -->
			</result>
		</action>
	</package>
</struts>
